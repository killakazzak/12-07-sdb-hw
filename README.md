# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Тен Денис`

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

### Решение Задание 1

#### Aктивный master-сервер и пассивный репликационный slave-сервер

Основные преимущества использования масштабирования методами активного master-сервера и пассивного репликационного slave-сервера включают следующее:

1. Высокая отказоустойчивость: Пассивный slave-сервер служит резервным экземпляром данных. Если основной master-сервер выходит из строя, пассивный сервер может автоматически взять на себя его роль и продолжить обслуживание без прерывания. Это обеспечивает непрерывность работы системы и предотвращает потерю данных при сбое.

2. Улучшенная доступность: Поскольку пассивный сервер автоматически заменяет основной сервер в случае сбоя, пользователи имеют непрерывный доступ к системе. Это особенно важно для приложений, требующих высокой доступности и минимального времени простоя.

3. Быстрое восстановление после сбоя: Когда основной сервер восстанавливается после сбоя, пассивный сервер может синхронизироваться с ним и передать все накопленные данные. Это позволяет быстро восстановить работу системы и минимизировать потери информации.

4. Распределение нагрузки: В нескольких ситуациях, активный master-сервер и пассивный slave-сервер могут обрабатывать запросы параллельно. Это позволяет распределить нагрузку между серверами, улучшая производительность и отклик системы.

5. Резервное копирование и восстановление: Пассивный сервер также может использоваться для резервного копирования данных с основного сервера. Это обеспечивает дополнительный уровень защиты данных и возможность восстановления системы в случае критических сбоев.

6. Географическая отказоустойчивость: Масштабирование с использованием активного master-сервера и пассивного slave-сервера может быть реализовано на разных физических местоположениях. Это позволяет обеспечить отказоустойчивость на географическом уровне, что полезно для систем, требующих глобального доступа и защиты от природных или технических бедствий.

В целом, использование активного master-сервера и пассивного репликационного slave-сервера обеспечивает высокую отказоустойчивость, доступность и распределение нагрузки в системе. Этот метод масштабирования является эффективным решением для обеспечения стабильной и надежной работы системы.


#### Мaster-сервер и несколько slave-серверов

Основные преимущества использования масштабирования методами, такими как master-сервер и несколько slave-серверов, включают следующее:

1. Распределение нагрузки: Использование нескольких slave-серверов позволяет распределить нагрузку между ними. Это позволяет более эффективно использовать ресурсы и обрабатывать больше запросов. Каждый slave-сервер может обслуживать определенное количество запросов, что увеличивает пропускную способность системы.

2. Увеличение производительности: Распределение нагрузки между master-сервером и slave-серверами позволяет обрабатывать больше запросов параллельно. Это увеличивает производительность системы и снижает время отклика для конечных пользователей.

3. Высокая отказоустойчивость: Наличие нескольких slave-серверов обеспечивает отказоустойчивость системы. Если один из серверов выходит из строя, остальные серверы могут продолжать работу и обслуживание пользователей без прерывания. Это помогает предотвратить простои системы и минимизировать потерю данных.

4. Горизонтальное масштабирование: Добавление новых slave-серверов в систему позволяет горизонтально масштабировать систему. Это означает, что можно увеличить пропускную способность системы, просто добавив новые серверы, вместо увеличения мощности одного сервера. Горизонтальное масштабирование обеспечивает гибкость и возможность расширения системы по мере роста потребностей.

5. Улучшенная безопасность данных: Использование slave-серверов позволяет создать резервные копии данных. Каждый slave-сервер может содержать копию данных, что обеспечивает дополнительный уровень защиты от потери данных в случае сбоя или ошибки.

6. Легкость в обслуживании: Распределение нагрузки между master-сервером и slave-серверами упрощает обслуживание системы. Если необходимо провести техническое обслуживание или обновление, можно отключить один slave-сервер, а остальные серверы продолжат работу. Это позволяет минимизировать простои и обеспечивает непрерывность работы системы.

В целом, использование масштабирования методами master-сервера и нескольких slave-серверов позволяет распределить нагрузку, увеличить производительность, обеспечить отказоустойчивость и улучшить безопасность данных. Этот подход к масштабированию обеспечивает гибкость и эффективность работы системы.

#### Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)

Основные преимущества использования масштабирования методом distributed replicated block device (DRBD) включают следующее:

1. Высокая отказоустойчивость: DRBD предоставляет механизм репликации данных между активным и пассивным серверами. Это обеспечивает отказоустойчивость системы, поскольку при сбое активного сервера пассивный сервер автоматически берет на себя работу и продолжает обслуживание без прерывания. Таким образом, DRBD помогает предотвратить потерю данных и минимизировать время простоя системы.

2. Гарантированная согласованность данных: DRBD обеспечивает согласованность данных между активным и пассивным серверами. Любые изменения данных, внесенные на активном сервере, автоматически реплицируются на пассивный сервер. Это гарантирует, что данные на обоих серверах всегда находятся в согласованном состоянии.

3. Быстрое восстановление после сбоя: Если активный сервер выходит из строя, DRBD позволяет быстро восстановить работу системы. Пассивный сервер может стать активным и продолжать обслуживание запросов без необходимости вручную восстанавливать данные или настраивать новый сервер.

4. Гибкость и масштабируемость: DRBD позволяет гибко масштабировать систему путем добавления дополнительных серверов. Благодаря репликации данных, новые серверы могут быть быстро включены в систему, а данные автоматически реплицируются на них. Это обеспечивает возможность увеличения пропускной способности и емкости системы по мере роста потребностей.

5. Улучшенная безопасность данных: DRBD обеспечивает дополнительный уровень защиты данных. Репликация данных на пассивные серверы гарантирует, что в случае сбоя или потери данных на активном сервере, данные остаются в безопасности на пассивных серверах. Это помогает предотвратить потерю критически важной информации.

6. Простота в управлении и настройке: DRBD предоставляет простой и интуитивно понятный интерфейс для управления и настройки репликации данных. Это упрощает процесс установки и конфигурации системы, а также обеспечивает удобство в управлении репликацией данных.

В целом, использование метода distributed replicated block device (DRBD) позволяет обеспечить высокую отказоустойчивость, согласованность данных, гибкость и улучшенную безопасность данных. DRBD является эффективным инструментом для создания надежной и масштабируемой системы.

#### SAN-кластер

Основные преимущества использования масштабирования методом SAN-кластера (Storage Area Network) включают следующее:

1. Высокая отказоустойчивость: SAN-кластер обеспечивает отказоустойчивость путем создания резервных копий данных и дублирования хранилища данных на нескольких узлах. Если один узел выходит из строя, другие узлы могут автоматически взять на себя его работу. Это обеспечивает непрерывность работы системы и предотвращает потерю данных.

2. Высокая производительность: SAN-кластер обеспечивает высокую производительность благодаря распределению нагрузки между несколькими узлами. Запросы к хранилищу данных могут быть обработаны параллельно узлами, что увеличивает пропускную способность системы и снижает время отклика.

3. Гибкость и масштабируемость: SAN-кластер позволяет гибко масштабировать систему путем добавления дополнительных узлов. Это обеспечивает возможность увеличения емкости хранилища данных и пропускной способности системы по мере роста потребностей. Гибкость SAN-кластера также позволяет легко добавлять новые устройства хранения данных или расширять существующие.

4. Централизованное управление: SAN-кластер обеспечивает централизованное управление хранилищем данных. Администраторы могут легко управлять и контролировать доступ к данным, настраивать политики резервного копирования и восстановления, а также мониторить производительность системы. Это упрощает администрирование и обеспечивает единый точка управления для всего хранилища данных.

5. Безопасность и защита данных: SAN-кластер предоставляет возможности для обеспечения безопасности и защиты данных. Доступ к данным может быть контролируем и ограничен с помощью различных механизмов аутентификации и авторизации. Кроме того, SAN-кластер обеспечивает функциональность резервного копирования и восстановления данных, что позволяет защитить данные от потери или повреждения.

6. Географическая отказоустойчивость: SAN-кластер может быть настроен для обеспечения отказоустойчивости на географическом уровне. Распределение хранилища данных между несколькими физическими местоположениями позволяет сохранять данные в безопасности даже при возникновении природных или технических бедствий в одной локации.

В целом, использование масштабирования методом SAN-кластера обеспечивает высокую отказоустойчивость, производительность, гибкость и безопасность данных. SAN-кластер является мощным инструментом для управления хранилищем данных и обеспечения надежности системы
#### Это самый дорогой способ, так требует развертывание дополнительной инфраструктуры для SAN


---

### Задание 2


Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

### Решение Задание 2

Для выполнения горизонтального и вертикального шаринга базы данных, можно разбить таблицы на несколько баз данных и распределить их между серверами. Вот план для выполнения шаринга:

1. Горизонтальный шаринг:
   - Разделяем таблицы между несколькими базами данных, чтобы данные были равномерно распределены. Например, пользователи с ID с 1 по 10000 могут быть в базе данных A, пользователи с ID с 10001 по 20000 - в базе данных B и т.д.
   - Устанавливаем механизм маршрутизации запросов, необходимо чтобы определить, в какой базе данных хранится необходимая информация. Можно использовать хэш-функцию для определения базы данных или простую логику маршрутизации на основе правил.
   - Устанавливаем репликацию данных между серверами для обеспечения отказоустойчивости и распределения нагрузки на чтение. Например, каждая база данных может иметь несколько реплик, и запросы на чтение могут быть маршрутизированы к ближайшей реплике.

2. Вертикальный шаринг:
   - Разделяем столбцы каждой таблицы между несколькими базами данных. Например, таблица пользователей может содержать только основную информацию о пользователях, а дополнительные данные (например, история заказов) могут быть вынесены в отдельную таблицу или базу данных.
   - Устанавливаем механизм связей между таблицами. Например, уникальный идентификатор пользователя может быть использован для связи таблиц пользователей и заказов.
   - Установите репликацию данных между серверами для обеспечения отказоустойчивости и распределения нагрузки на чтение, аналогично горизонтальному шарингу.

Вот блок-схема для данной системы:

![image](https://github.com/killakazzak/12-07-sdb-hw/assets/32342205/eeff8cae-9bce-4814-bdcd-7f17f24f3950)


Сервера будут работать в следующих режимах:

- Режим записи: пользовательские запросы на изменение данных будут направляться к соответствующей базе данных (например, база данных A). Записи будут реплицироваться на другие серверы внутри этой базы данных для обеспечения отказоустойчивости и сохранности данных.
- Режим чтения: пользовательские запросы на чтение данных могут быть направлены к любой базе данных (A, B или C) в зависимости от логики маршрутизации. Чтение может быть выполнено на ближайшей реплике для улучшения производительности и распределения нагрузки на чтение.

Таким образом, горизонтальный и вертикальный шаринг позволяют распределить данные между несколькими серверами и базами данных


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.

### Решение Задание 3*

